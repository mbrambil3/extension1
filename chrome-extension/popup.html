<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto-Summarizer</title>
    <link rel="stylesheet" href="popup.css">
    <style>
      /* leve diferen√ßa de cores entre os bot√µes Assinar e Ativar */
      .btn-subscribe { background: #2563eb; color: #fff; }
      .btn-subscribe:hover { background: #1d4ed8; }
      .btn-activate { background: #f1f5f9; color: #0f172a; }
      .btn-activate.disabled { opacity: 0.6; cursor: not-allowed; }
      .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="popup-container">
        <div class="popup-header">
            <h2>üìÑ Auto-Summarizer</h2>
            <p class="version">v1.0.6</p>
        </div>
        
        <div class="popup-content">
            <!-- Resumo Autom√°tico acima dos bot√µes -->
            <div class="setting-item" style="margin-bottom:12px;">
                <label class="toggle-label">
                    <input type="checkbox" id="autoSummary" class="toggle-input">
                    <span class="toggle-slider"></span>
                    <span class="toggle-text">Resumo Autom√°tico</span>
                </label>
                <small class="setting-description">Gerar resumos automaticamente ao detectar artigos longos</small>
            </div>

            <div class="action-group">
                <div style="display:flex; gap:8px;">
                  <button id="generateNow" class="primary-btn" style="flex:1;">
                      üéØ Gerar Resumo Agora
                  </button>
                  <button id="stopNow" class="secondary-btn" style="flex:1; display:none;">
                      ‚èπÔ∏è Parar
                  </button>
                </div>
                
                <button id="viewHistory" class="secondary-btn">
                    üìö Ver Hist√≥rico
                </button>

                <div class="separator" style="height:1px;background:#e2e8f0;margin:12px 0;"></div>
                <label for="pdfInput" class="secondary-btn" style="display:block;text-align:center;cursor:pointer;">
                    üìÑ Importar PDF para Resumo
                    <input id="pdfInput" type="file" accept="application/pdf" style="display:none" />
                </label>
            </div>

            <div class="setting-group" style="margin-top:16px;">

                <div class="setting-item">
                    <label for="language" class="setting-label">Idioma do Resumo</label>
                    <select id="language" class="setting-select">
                        <option value="pt">Portugu√™s</option>
                        <option value="en">Ingl√™s</option>
                    </select>
                </div>
                
                <div class="setting-item">
                    <label for="detailLevel" class="setting-label">N√≠vel de Detalhe</label>
                    <select id="detailLevel" class="setting-select">
                        <option value="short">Breve</option>
                        <option value="medium">M√©dio</option>
                        <option value="long">Detalhado</option>
                    </select>
                </div>

                <div class="setting-item">
                    <label for="persona" class="setting-label">Personalidade do Resumo</label>
                    <input id="persona" type="text" class="setting-select" placeholder="Ex.: Assertivo, Engra√ßado, Personagem do..." />
                    <small class="setting-description" style="margin-left:0;">Descreva como deseja o tom do resumo</small>
                </div>

                <div class="setting-item" style="border-top:1px solid #e2e8f0; margin-top:8px; padding-top:8px;">
                    <label class="setting-label">Plano e Limites</label>
                    <div id="planStatus" class="setting-description">Plano: Free ‚Ä¢ Hoje: 0/30</div>
                    
                    <div style="display:flex; flex-direction:column; gap:8px; margin-top:6px; align-items:stretch;">
                        <!-- Novo bot√£o Assinar Premium (some quando Premium) -->
                        <button id="subscribeBtn" class="secondary-btn btn-subscribe" style="flex:0 0 auto;">Assinar Premium</button>
                        <!-- Bot√£o Ativar Premium existente -->
                        <button id="applyKeyBtn" class="secondary-btn btn-activate" style="flex:0 0 auto;">Ativar Premium</button>
                    </div>

                    <!-- Resgatar por e-mail: inserir e-mail do checkout e buscar KEY -->
                    <div class="setting-item" id="claimGroup" style="margin-top:8px;">
                        <label class="setting-label">Resgatar por e-mail</label>
                        <div style="display:flex; gap:8px; align-items:center;">
                            <input id="claimEmail" type="email" class="setting-select" placeholder="E-mail da compra" style="flex:1; height:38px; border-radius:8px;" />
                            <button id="claimBtn" class="secondary-btn" style="flex:0 0 auto;">Resgatar</button>
                        </div>
                        <small class="setting-description" style="display:block; margin-left:0;">Use o e-mail do checkout para obter sua KEY com seguran√ßa.</small>
                    </div>
                    
                    <input id="subscriptionKey" type="text" class="setting-select" placeholder="KEY de ASSINATURA" style="width:100%; margin-top:8px; height:38px; border-radius:8px;" />
                    <small id="subscriptionHint" class="setting-description" style="display:block; margin-left:0;">Insira sua KEY para liberar Premium.</small>
                </div>

                <details id="advancedOptions">
                  <summary>Op√ß√µes avan√ßadas</summary>
                  <div class="setting-item" style="margin-top:10px;">
                    <label for="openrouterKey" class="setting-label">OpenRouter API Key (opcional)</label>
                    <input id="openrouterKey" type="password" class="setting-select" placeholder="sk-or-v1-..." />
                    <small class="setting-description">Se preencher, usaremos sua pr√≥pria cota. Em branco, usamos a chave padr√£o.</small>
                  </div>

                </details>
            </div>
            
            <div class="info-group">
                <div class="shortcut-info">
                    <span class="shortcut-label">Atalho:</span>
                    <code class="shortcut-key">Ctrl+Shift+S</code>
                </div>
                
                <div class="status-indicator">
                    <span class="status-dot api-status active"></span>
                    <span class="status-text">Conex√£o API Ativa</span>
                </div>
            </div>
        </div>
        
        <div class="popup-footer">
            <small id="providerDisplay">Powered by Deepseek</small>
        </div>
    </div>
    
    <div id="toast-container" class="toast-container"></div>
    <script src="pdfjs/pdf.min.js"></script>
    <script src="popup.js"></script>
</body>
</html>